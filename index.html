<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Live Board</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        body { margin: 0; background: #000; color: white; font-family: sans-serif; overflow: hidden; }
        .slide { display: none; width: 100vw; height: 100vh; position: relative; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        iframe { width: 100%; height: 100%; border: none; }
        .content-box { padding: 40px; width: 90%; }
        .news-header { color: #ff4444; font-size: 4rem; border-bottom: 5px solid #ff4444; margin-bottom: 20px; }
        .text { font-size: 3rem; font-weight: bold; white-space: pre-wrap; text-shadow: 4px 4px 15px #000; }
        #clock { position: absolute; top: 15px; right: 25px; font-size: 2.5rem; background: rgba(0,0,0,0.8); padding: 5px 20px; border-radius: 12px; z-index: 100; }
        /* Таймер */
        .timer-grid { display: flex; gap: 20px; }
        .flip { background: #1a1a1a; padding: 20px; border-radius: 10px; font-size: 5rem; border: 1px solid #333; }
        .label { font-size: 1.2rem; color: #aaa; margin-top: 5px; }
    </style>
</head>
<body>
    <div id="clock">00:00</div>
    <div id="display"></div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyDI5emOGELK-Ac4lCn_7nIoT-okhEQgVfY",
        authDomain: "myboard-42e97.firebaseapp.com",
        databaseURL: "https://myboard-42e97-default-rtdb.firebaseio.com",
        projectId: "myboard-42e97",
        storageBucket: "myboard-42e97.firebasestorage.app",
        messagingSenderId: "819814141254",
        appId: "1:819814141254:web:abcfad133a915762ae6947"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database().ref('slides');

    let slidesData = [];
    let currentIndex = 0;

    db.on('value', (snap) => {
        slidesData = [];
        snap.forEach(child => { slidesData.push(child.val()); });
        if (slidesData.length > 0) renderSlide();
    });

    function renderSlide() {
        const display = document.getElementById('display');
        display.innerHTML = '';
        const data = slidesData[currentIndex];
        if (!data) return;

        const slide = document.createElement('div');
        slide.className = 'slide';
        slide.style.display = 'flex';

        if (data.type === 'карта') {
            slide.innerHTML = `<iframe src="${data.body}"></iframe>`;
        } else if (data.type === 'хронометр') {
            slide.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.6),rgba(0,0,0,0.6)), url('${data.bg}')`;
            slide.style.backgroundSize = 'cover';
            slide.innerHTML = `<div class="content-box"><div id="live-timer" class="timer-grid"></div></div>`;
            startTimerLogic();
        } else if (data.type === 'новини') {
            slide.innerHTML = `<div class="content-box"><div class="news-header">НОВИНИ</div><div class="text">${data.body}</div></div>`;
        } else if (data.type === 'вітання') {
            slide.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.4),rgba(0,0,0,0.4)), url('${data.bg}')`;
            slide.style.backgroundSize = 'cover';
            slide.innerHTML = `<div class="content-box"><div class="text">${data.body}</div></div>`;
        }

        display.appendChild(slide);
        
        setTimeout(() => {
            currentIndex = (currentIndex + 1) % slidesData.length;
            renderSlide();
        }, 30000);
    }

    function startTimerLogic() {
        const update = () => {
            const el = document.getElementById('live-timer');
            if (!el) return;
            const diff = new Date() - new Date('2022-02-24T05:00:00');
            const d = Math.floor(diff / 86400000);
            const h = Math.floor((diff / 3600000) % 24);
            const m = Math.floor((diff / 60000) % 60);
            const s = Math.floor((diff / 1000) % 60);
            el.innerHTML = `<div><div class="flip">${d}</div><div class="label">Днів</div></div>` +
                           `<div><div class="flip">${h}</div><div class="label">Год</div></div>` +
                           `<div><div class="flip">${m}</div><div class="label">Хв</div></div>` +
                           `<div><div class="flip">${s}</div><div class="label">Сек</div></div>`;
        };
        setInterval(update, 1000); update();
    }

    setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString('uk-UA', {hour:'2-digit', minute:'2-digit'}); }, 1000);
</script>
</body>
</html>
